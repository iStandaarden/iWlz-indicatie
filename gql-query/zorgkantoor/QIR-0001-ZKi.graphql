# QIR-0001-ZKi.graphql
# Query voor initieel Verantwoordelijk Zorgkantoor op Indicatieregister
# Verplichte input:
#   - wlzIndicatieID = te raadplegen WlzIndicatie
#   - uzovicode zorgkantoor = eigen uzovicode raadpleger
#   - datum vandaag

query WlzIndicatie(
    $wlzIndicatieID: UUID!
    $initieelVerantwoordelijkZorgkantoor: String!
    $now: Date!
) {
    wlzIndicatie(
        where: {
            wlzIndicatieID: {eq: $wlzIndicatieID}
            initieelVerantwoordelijkZorgkantoor: {eq: $initieelVerantwoordelijkZorgkantoor}
        }
    ) {
        wlzIndicatieID
        bsn
        besluitnummer
        soortWlzindicatie
        afgiftedatum
        ingangsdatum
        einddatum
        meerzorg
        initieelVerantwoordelijkZorgkantoor
        vervaldatum
        commentaar
        grondslag {
            grondslagID
            grondslag
            volgorde
        }
        geindiceerdZorgzwaartepakket {
            geindiceerdZorgzwaartepakketID
            zzpCode
            ingangsdatum
            einddatum
            voorkeurClient
            instellingVoorkeur
            financiering
            commentaar
        }
        beperking {
            beperkingID
            categorie
            duur
            commentaar
            beperkingScore {
                beperkingScoreID
                beperkingVraag
                beperkingScore
                commentaar
            }
        }
        stoornis {
            stoornisID
            grondslag
            diagnoseCodelijst
            diagnoseSubCodelijst
            ziektebeeldStoornis
            prognose
            commentaar
        }
        stoornisScore {
            stoornisScoreID
            stoornisVraag
            stoornisScore
            commentaar
        }
        wzd {
            wzdID
            wzdVerklaring
            ingangsdatum
            einddatum
        }
        client {
            clientID
            bsn
            geheimeClient
            geboorteDatum
            geboortedatumGebruik
            geslacht
            burgerlijkeStaat
            geslachtsnaam
            voorvoegselGeslachtsnaam
            partnernaam
            voorvoegselPartnernaam
            voornamen
            roepnaam
            voorletters
            naamGebruik
            leefeenheid
            agbcodeHuisarts
            communicatieVorm
            taal
            commentaar
            contactGegevens {
                contactGegevensID
                adres(
                    where: 
                    {
                        or:[
                            {einddatum: {gt: $now}, einddatum: {eq: null}}
                        ],
                        ingangsdatum: {ngt: $now}
                    }
                ) {
                    adresID
                    adresSoort
                    straatnaam
                    huisnummer
                    huisnummerToevoeging
                    postcode
                    plaatsnaam
                    landCode
                    aanduidingWoonadres
                    ingangsdatum
                    einddatum
                }
                email (
                    where: 
                    {
                        or:[
                            {einddatum: {gt: $now}, einddatum: {eq: null}}
                        ],
                        ingangsdatum: {ngt: $now}
                    }
                ) {
                    emailID
                    emailadres
                    ingangsdatum
                    einddatum
                }
                telefoon (
                    where: 
                    {
                        or:[
                            {einddatum: {gt: $now}, einddatum: {eq: null}}
                        ],
                        ingangsdatum: {ngt: $now}
                    }
                ) {
                    telefoonID
                    telefoonnummer
                    landnummer
                    ingangsdatum
                    einddatum
                }
            }
            contactPersoon (
                where: 
                {
                    or:[
                        {einddatum: {gt: $now}, einddatum: {eq: null}}
                    ],
                    ingangsdatum: {ngt: $now}
                }
            ){
                contactPersoonID
                relatieNummer
                volgorde
                soortRelatie
                rol
                relatie
                voornamen
                roepnaam
                voorletters
                geslachtsnaam
                voorvoegselGeslachtsnaam
                partnernaam
                voorvoegselPartnernaam
                naamGebruik
                geslacht
                geboorteDatum
                geboortedatumGebruik
                ingangsdatum
                einddatum
                contactGegevens {
                    contactGegevensID
                    adres(
                        where: 
                        {
                            or:[
                                {einddatum: {gt: $now}, einddatum: {eq: null}}
                            ],
                            ingangsdatum: {ngt: $now}
                        }
                    ) {
                        adresID
                        adresSoort
                        straatnaam
                        huisnummer
                        huisnummerToevoeging
                        postcode
                        plaatsnaam
                        landCode
                        aanduidingWoonadres
                        ingangsdatum
                        einddatum
                    }
                    email (
                        where: 
                        {
                            or:[
                                {einddatum: {gt: $now}, einddatum: {eq: null}}
                            ],
                            ingangsdatum: {ngt: $now}
                        }
                    ) {
                        emailID
                        emailadres
                        ingangsdatum
                        einddatum
                    }
                    telefoon (
                        where: 
                        {
                            or:[
                                {einddatum: {gt: $now}, einddatum: {eq: null}}
                            ],
                            ingangsdatum: {ngt: $now}
                        }
                    ) {
                        telefoonID
                        telefoonnummer
                        landnummer
                        ingangsdatum
                        einddatum
                    }
                }
            }
        }
    }
}
